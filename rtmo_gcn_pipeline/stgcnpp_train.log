nohup: ignoring input
07/29 02:04:01 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.14 (main, May  6 2024, 19:42:50) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 42
    GPU 0,1: NVIDIA RTX A5000
    CUDA_HOME: /usr/local/cuda
    NVCC: Cuda compilation tools, release 12.1, V12.1.105
    GCC: gcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0
    PyTorch: 2.3.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.3.6 (Git Hash 86e6af5974177e513fd3fee58425e1063e7f1361)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 12.1
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.9.2
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=12.1, CUDNN_VERSION=8.9.2, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.3.1, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=1, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

    TorchVision: 0.18.1
    OpenCV: 4.10.0
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: False
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 42
    deterministic: False
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

07/29 02:04:01 - mmengine - INFO - Config:
ann_file = 'data/skeleton/ntu60_2d.pkl'
ann_file_test = '/workspace/rtmo_gcn_pipeline/rtmo_pose_track/output/rwf2000_enhanced_test.pkl'
ann_file_train = '/workspace/rtmo_gcn_pipeline/rtmo_pose_track/output/rwf2000_enhanced_train.pkl'
ann_file_val = '/workspace/rtmo_gcn_pipeline/rtmo_pose_track/output/rwf2000_enhanced_val.pkl'
auto_scale_lr = dict(base_batch_size=128, enable=False)
custom_hooks = [
    dict(
        monitor='acc/top1',
        patience=5,
        rule='greater',
        type='EarlyStoppingHook'),
]
data_root = '/workspace/rtmo_gcn_pipeline/rtmo_pose_track/output/RWF-2000/'
dataset_type = 'PoseDataset'
default_hooks = dict(
    checkpoint=dict(
        interval=5, max_keep_ckpts=3, save_best='auto', type='CheckpointHook'),
    logger=dict(ignore_last=False, interval=50, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    runtime_info=dict(type='RuntimeInfoHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    sync_buffers=dict(type='SyncBuffersHook'),
    timer=dict(type='IterTimerHook'))
default_scope = 'mmaction'
env_cfg = dict(
    cudnn_benchmark=False,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
launcher = 'none'
load_from = None
log_level = 'INFO'
log_processor = dict(by_epoch=True, type='LogProcessor', window_size=20)
model = dict(
    backbone=dict(
        gcn_adaptive='init',
        gcn_with_res=True,
        graph_cfg=dict(layout='coco', mode='spatial'),
        tcn_type='mstcn',
        type='STGCN'),
    cls_head=dict(
        in_channels=256,
        loss_cls=dict(class_weight=[
            1.0,
            1.2,
        ], type='CrossEntropyLoss'),
        num_classes=2,
        type='GCNHead'),
    type='RecognizerGCN')
optim_wrapper = dict(
    clip_grad=dict(max_norm=40, norm_type=2),
    loss_scale='dynamic',
    optimizer=dict(lr=0.001, type='AdamW', weight_decay=0.0005),
    type='AmpOptimWrapper')
param_scheduler = [
    dict(
        begin=0,
        by_epoch=True,
        convert_to_iter_based=True,
        end=5,
        start_factor=0.001,
        type='LinearLR'),
    dict(
        T_max=50,
        begin=5,
        by_epoch=True,
        eta_min_ratio=0.01,
        type='CosineAnnealingLR'),
]
randomness = dict(deterministic=False, seed=42)
resume = True
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=8,
    dataset=dict(
        ann_file=
        '/workspace/rtmo_gcn_pipeline/rtmo_pose_track/output/rwf2000_enhanced_val.pkl',
        pipeline=[
            dict(type='PreNormalize2D'),
            dict(dataset='coco', feats=[
                'b',
            ], type='GenSkeFeat'),
            dict(
                clip_len=100,
                num_clips=1,
                test_mode=True,
                type='UniformSampleFrames'),
            dict(type='PoseDecode'),
            dict(num_person=2, type='FormatGCNInput'),
            dict(type='PackActionInputs'),
        ],
        test_mode=True,
        type='PoseDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = [
    dict(
        metric_options=dict(
            mean_class_accuracy=dict(), top_k_accuracy=dict(topk=(1, ))),
        type='AccMetric'),
]
test_pipeline = [
    dict(type='PreNormalize2D'),
    dict(dataset='coco', feats=[
        'b',
    ], type='GenSkeFeat'),
    dict(
        clip_len=100, num_clips=10, test_mode=True,
        type='UniformSampleFrames'),
    dict(type='PoseDecode'),
    dict(num_person=2, type='FormatGCNInput'),
    dict(type='PackActionInputs'),
]
train_cfg = dict(
    max_epochs=50, type='EpochBasedTrainLoop', val_begin=1, val_interval=2)
train_dataloader = dict(
    batch_size=8,
    dataset=dict(
        ann_file=
        '/workspace/rtmo_gcn_pipeline/rtmo_pose_track/output/rwf2000_enhanced_train.pkl',
        pipeline=[
            dict(type='PreNormalize2D'),
            dict(dataset='coco', feats=[
                'b',
            ], type='GenSkeFeat'),
            dict(clip_len=100, type='UniformSampleFrames'),
            dict(type='PoseDecode'),
            dict(num_person=2, type='FormatGCNInput'),
            dict(type='PackActionInputs'),
        ],
        test_mode=False,
        type='PoseDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='DefaultSampler'))
train_pipeline = [
    dict(type='PreNormalize2D'),
    dict(dataset='coco', feats=[
        'b',
    ], type='GenSkeFeat'),
    dict(clip_len=100, type='UniformSampleFrames'),
    dict(type='PoseDecode'),
    dict(num_person=2, type='FormatGCNInput'),
    dict(type='PackActionInputs'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=8,
    dataset=dict(
        ann_file=
        '/workspace/rtmo_gcn_pipeline/rtmo_pose_track/output/rwf2000_enhanced_val.pkl',
        pipeline=[
            dict(type='PreNormalize2D'),
            dict(dataset='coco', feats=[
                'b',
            ], type='GenSkeFeat'),
            dict(
                clip_len=100,
                num_clips=1,
                test_mode=True,
                type='UniformSampleFrames'),
            dict(type='PoseDecode'),
            dict(num_person=2, type='FormatGCNInput'),
            dict(type='PackActionInputs'),
        ],
        test_mode=True,
        type='PoseDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = [
    dict(
        metric_options=dict(
            mean_class_accuracy=dict(), top_k_accuracy=dict(topk=(1, ))),
        type='AccMetric'),
]
val_pipeline = [
    dict(type='PreNormalize2D'),
    dict(dataset='coco', feats=[
        'b',
    ], type='GenSkeFeat'),
    dict(
        clip_len=100, num_clips=1, test_mode=True, type='UniformSampleFrames'),
    dict(type='PoseDecode'),
    dict(num_person=2, type='FormatGCNInput'),
    dict(type='PackActionInputs'),
]
vis_backends = [
    dict(type='LocalVisBackend'),
    dict(type='TensorboardVisBackend'),
]
visualizer = dict(
    type='ActionVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
        dict(type='TensorboardVisBackend'),
    ])
work_dir = '/workspace/mmaction2/work_dirs/enhanced_fight_plus_stgcn_v3'

07/29 02:04:02 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
07/29 02:04:02 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
(LOWEST      ) EarlyStoppingHook                  
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SyncBuffersHook                    
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SyncBuffersHook                    
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
(LOWEST      ) EarlyStoppingHook                  
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
07/29 02:04:03 - mmengine - INFO - 2723 videos remain after valid thresholding
07/29 02:04:03 - mmengine - INFO - 778 videos remain after valid thresholding
Did not find last_checkpoint to be resumed.
07/29 02:04:03 - mmengine - INFO - Auto resumed from the latest checkpoint None.
07/29 02:04:03 - mmengine - WARNING - "FileClient" will be deprecated in future. Please use io functions in https://mmengine.readthedocs.io/en/latest/api/fileio.html#file-io
07/29 02:04:03 - mmengine - WARNING - "HardDiskBackend" is the alias of "LocalBackend" and the former will be deprecated in future.
07/29 02:04:03 - mmengine - INFO - Checkpoints will be saved to /workspace/mmaction2/work_dirs/enhanced_fight_plus_stgcn_v3.
07/29 02:04:09 - mmengine - INFO - Epoch(train)  [1][ 50/341]  lr: 2.9727e-05  eta: 0:32:52  time: 0.0875  data_time: 0.0042  memory: 607  grad_norm: 3.7766  loss: 0.6460  top1_acc: 1.0000  top5_acc: 1.0000  loss_cls: 0.6460
07/29 02:04:14 - mmengine - INFO - Epoch(train)  [1][100/341]  lr: 5.9040e-05  eta: 0:28:53  time: 0.0870  data_time: 0.0041  memory: 607  grad_norm: 2.7240  loss: 0.5956  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.5956
07/29 02:04:18 - mmengine - INFO - Epoch(train)  [1][150/341]  lr: 8.8354e-05  eta: 0:27:36  time: 0.0881  data_time: 0.0041  memory: 607  grad_norm: 4.7499  loss: 0.5723  top1_acc: 0.3750  top5_acc: 1.0000  loss_cls: 0.5723
07/29 02:04:22 - mmengine - INFO - Epoch(train)  [1][200/341]  lr: 1.1767e-04  eta: 0:26:46  time: 0.0865  data_time: 0.0042  memory: 607  grad_norm: 5.9836  loss: 0.5505  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.5505
07/29 02:04:27 - mmengine - INFO - Epoch(train)  [1][250/341]  lr: 1.4698e-04  eta: 0:26:11  time: 0.0844  data_time: 0.0041  memory: 607  grad_norm: 5.6209  loss: 0.5632  top1_acc: 0.3750  top5_acc: 1.0000  loss_cls: 0.5632
07/29 02:04:31 - mmengine - INFO - Epoch(train)  [1][300/341]  lr: 1.7629e-04  eta: 0:26:00  time: 0.0903  data_time: 0.0042  memory: 607  grad_norm: 5.0336  loss: 0.5818  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.5818
07/29 02:04:35 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:04:35 - mmengine - INFO - Epoch(train)  [1][341/341]  lr: 2.0033e-04  eta: 0:25:59  time: 0.1000  data_time: 0.0042  memory: 607  grad_norm: 3.9218  loss: 0.4775  top1_acc: 1.0000  top5_acc: 1.0000  loss_cls: 0.4775
07/29 02:04:40 - mmengine - INFO - Epoch(train)  [2][ 50/341]  lr: 2.2964e-04  eta: 0:25:48  time: 0.0909  data_time: 0.0044  memory: 607  grad_norm: 4.4606  loss: 0.4292  top1_acc: 1.0000  top5_acc: 1.0000  loss_cls: 0.4292
07/29 02:04:44 - mmengine - INFO - Epoch(train)  [2][100/341]  lr: 2.5896e-04  eta: 0:25:32  time: 0.0852  data_time: 0.0041  memory: 607  grad_norm: 4.0905  loss: 0.4788  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4788
07/29 02:04:49 - mmengine - INFO - Epoch(train)  [2][150/341]  lr: 2.8827e-04  eta: 0:25:32  time: 0.0962  data_time: 0.0045  memory: 607  grad_norm: 4.3833  loss: 0.5809  top1_acc: 0.8750  top5_acc: 1.0000  loss_cls: 0.5809
07/29 02:04:54 - mmengine - INFO - Epoch(train)  [2][200/341]  lr: 3.1758e-04  eta: 0:25:32  time: 0.0959  data_time: 0.0044  memory: 607  grad_norm: 4.1847  loss: 0.5304  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.5304
07/29 02:04:58 - mmengine - INFO - Epoch(train)  [2][250/341]  lr: 3.4690e-04  eta: 0:25:32  time: 0.0956  data_time: 0.0044  memory: 607  grad_norm: 4.0882  loss: 0.5262  top1_acc: 0.5000  top5_acc: 1.0000  loss_cls: 0.5262
07/29 02:05:03 - mmengine - INFO - Epoch(train)  [2][300/341]  lr: 3.7621e-04  eta: 0:25:30  time: 0.0956  data_time: 0.0044  memory: 607  grad_norm: 4.1857  loss: 0.5093  top1_acc: 0.5000  top5_acc: 1.0000  loss_cls: 0.5093
07/29 02:05:07 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:05:07 - mmengine - INFO - Epoch(train)  [2][341/341]  lr: 4.0025e-04  eta: 0:25:28  time: 0.0951  data_time: 0.0043  memory: 607  grad_norm: 4.3481  loss: 0.5671  top1_acc: 0.6667  top5_acc: 1.0000  loss_cls: 0.5671
07/29 02:05:09 - mmengine - INFO - Epoch(val)  [2][50/98]    eta: 0:00:01  time: 0.0304  data_time: 0.0040  memory: 187  
07/29 02:05:10 - mmengine - INFO - Epoch(val) [2][98/98]    acc/top1: 0.7622  acc/mean1: 0.7450  data_time: 0.0058  time: 0.0342
07/29 02:05:11 - mmengine - INFO - The best checkpoint with 0.7622 acc/top1 at 2 epoch is saved to best_acc_top1_epoch_2.pth.
07/29 02:05:15 - mmengine - INFO - Epoch(train)  [3][ 50/341]  lr: 4.2956e-04  eta: 0:25:25  time: 0.0911  data_time: 0.0043  memory: 607  grad_norm: 3.9427  loss: 0.5322  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.5322
07/29 02:05:20 - mmengine - INFO - Epoch(train)  [3][100/341]  lr: 4.5888e-04  eta: 0:25:13  time: 0.0846  data_time: 0.0042  memory: 607  grad_norm: 3.4804  loss: 0.5542  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.5542
07/29 02:05:24 - mmengine - INFO - Epoch(train)  [3][150/341]  lr: 4.8819e-04  eta: 0:25:03  time: 0.0881  data_time: 0.0042  memory: 607  grad_norm: 3.0454  loss: 0.5450  top1_acc: 0.3750  top5_acc: 1.0000  loss_cls: 0.5450
07/29 02:05:29 - mmengine - INFO - Epoch(train)  [3][200/341]  lr: 5.1750e-04  eta: 0:24:58  time: 0.0954  data_time: 0.0045  memory: 607  grad_norm: 4.1021  loss: 0.5896  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.5896
07/29 02:05:33 - mmengine - INFO - Epoch(train)  [3][250/341]  lr: 5.4682e-04  eta: 0:24:54  time: 0.0923  data_time: 0.0043  memory: 607  grad_norm: 2.8414  loss: 0.5259  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.5259
07/29 02:05:38 - mmengine - INFO - Epoch(train)  [3][300/341]  lr: 5.7613e-04  eta: 0:24:47  time: 0.0903  data_time: 0.0044  memory: 607  grad_norm: 3.4496  loss: 0.5192  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.5192
07/29 02:05:39 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:05:42 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:05:42 - mmengine - INFO - Epoch(train)  [3][341/341]  lr: 6.0017e-04  eta: 0:24:42  time: 0.0879  data_time: 0.0041  memory: 607  grad_norm: 2.8107  loss: 0.4544  top1_acc: 0.6667  top5_acc: 1.0000  loss_cls: 0.4544
07/29 02:05:46 - mmengine - INFO - Epoch(train)  [4][ 50/341]  lr: 6.2948e-04  eta: 0:24:35  time: 0.0900  data_time: 0.0044  memory: 607  grad_norm: 3.2160  loss: 0.5497  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.5497
07/29 02:05:51 - mmengine - INFO - Epoch(train)  [4][100/341]  lr: 6.5879e-04  eta: 0:24:32  time: 0.1017  data_time: 0.0042  memory: 607  grad_norm: 3.3493  loss: 0.5251  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.5251
07/29 02:05:55 - mmengine - INFO - Epoch(train)  [4][150/341]  lr: 6.8811e-04  eta: 0:24:26  time: 0.0893  data_time: 0.0042  memory: 607  grad_norm: 2.8533  loss: 0.5313  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.5313
07/29 02:06:00 - mmengine - INFO - Epoch(train)  [4][200/341]  lr: 7.1742e-04  eta: 0:24:18  time: 0.0888  data_time: 0.0042  memory: 607  grad_norm: 3.1103  loss: 0.5469  top1_acc: 1.0000  top5_acc: 1.0000  loss_cls: 0.5469
07/29 02:06:04 - mmengine - INFO - Epoch(train)  [4][250/341]  lr: 7.4673e-04  eta: 0:24:12  time: 0.0897  data_time: 0.0042  memory: 607  grad_norm: 2.3808  loss: 0.4874  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4874
07/29 02:06:08 - mmengine - INFO - Epoch(train)  [4][300/341]  lr: 7.7605e-04  eta: 0:24:04  time: 0.0875  data_time: 0.0042  memory: 607  grad_norm: 2.8454  loss: 0.5513  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.5513
07/29 02:06:12 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:06:12 - mmengine - INFO - Epoch(train)  [4][341/341]  lr: 8.0008e-04  eta: 0:24:00  time: 0.0902  data_time: 0.0041  memory: 607  grad_norm: 2.2913  loss: 0.5049  top1_acc: 0.6667  top5_acc: 1.0000  loss_cls: 0.5049
07/29 02:06:14 - mmengine - INFO - Epoch(val)  [4][50/98]    eta: 0:00:01  time: 0.0292  data_time: 0.0038  memory: 187  
07/29 02:06:15 - mmengine - INFO - Epoch(val) [4][98/98]    acc/top1: 0.6928  acc/mean1: 0.7189  data_time: 0.0040  time: 0.0301
07/29 02:06:20 - mmengine - INFO - Epoch(train)  [5][ 50/341]  lr: 8.2940e-04  eta: 0:23:55  time: 0.0869  data_time: 0.0042  memory: 607  grad_norm: 2.4696  loss: 0.5439  top1_acc: 0.8750  top5_acc: 1.0000  loss_cls: 0.5439
07/29 02:06:24 - mmengine - INFO - Epoch(train)  [5][100/341]  lr: 8.5871e-04  eta: 0:23:48  time: 0.0874  data_time: 0.0042  memory: 607  grad_norm: 2.3197  loss: 0.4418  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4418
07/29 02:06:28 - mmengine - INFO - Epoch(train)  [5][150/341]  lr: 8.8802e-04  eta: 0:23:42  time: 0.0896  data_time: 0.0043  memory: 607  grad_norm: 2.0566  loss: 0.4753  top1_acc: 0.5000  top5_acc: 1.0000  loss_cls: 0.4753
07/29 02:06:33 - mmengine - INFO - Epoch(train)  [5][200/341]  lr: 9.1734e-04  eta: 0:23:36  time: 0.0872  data_time: 0.0042  memory: 607  grad_norm: 2.2125  loss: 0.4649  top1_acc: 1.0000  top5_acc: 1.0000  loss_cls: 0.4649
07/29 02:06:37 - mmengine - INFO - Epoch(train)  [5][250/341]  lr: 9.4665e-04  eta: 0:23:31  time: 0.0851  data_time: 0.0041  memory: 607  grad_norm: 2.6345  loss: 0.5403  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.5403
07/29 02:06:42 - mmengine - INFO - Epoch(train)  [5][300/341]  lr: 9.7596e-04  eta: 0:23:25  time: 0.0887  data_time: 0.0042  memory: 607  grad_norm: 2.5283  loss: 0.4905  top1_acc: 0.8750  top5_acc: 1.0000  loss_cls: 0.4905
07/29 02:06:45 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:06:45 - mmengine - INFO - Epoch(train)  [5][341/341]  lr: 1.0000e-03  eta: 0:23:19  time: 0.0881  data_time: 0.0041  memory: 607  grad_norm: 2.2535  loss: 0.4880  top1_acc: 0.6667  top5_acc: 1.0000  loss_cls: 0.4880
07/29 02:06:45 - mmengine - INFO - Saving checkpoint at 5 epochs
07/29 02:06:50 - mmengine - INFO - Epoch(train)  [6][ 50/341]  lr: 1.0000e-03  eta: 0:23:13  time: 0.0877  data_time: 0.0043  memory: 607  grad_norm: 2.4062  loss: 0.5525  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.5525
07/29 02:06:54 - mmengine - INFO - Epoch(train)  [6][100/341]  lr: 1.0000e-03  eta: 0:23:08  time: 0.0873  data_time: 0.0043  memory: 607  grad_norm: 2.2241  loss: 0.5751  top1_acc: 0.5000  top5_acc: 1.0000  loss_cls: 0.5751
07/29 02:06:59 - mmengine - INFO - Epoch(train)  [6][150/341]  lr: 1.0000e-03  eta: 0:23:02  time: 0.0883  data_time: 0.0043  memory: 607  grad_norm: 1.8864  loss: 0.4241  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4241
07/29 02:07:03 - mmengine - INFO - Epoch(train)  [6][200/341]  lr: 1.0000e-03  eta: 0:22:56  time: 0.0877  data_time: 0.0042  memory: 607  grad_norm: 1.6674  loss: 0.4433  top1_acc: 0.5000  top5_acc: 1.0000  loss_cls: 0.4433
07/29 02:07:08 - mmengine - INFO - Epoch(train)  [6][250/341]  lr: 1.0000e-03  eta: 0:22:51  time: 0.0906  data_time: 0.0044  memory: 607  grad_norm: 1.9288  loss: 0.4260  top1_acc: 1.0000  top5_acc: 1.0000  loss_cls: 0.4260
07/29 02:07:11 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:07:12 - mmengine - INFO - Epoch(train)  [6][300/341]  lr: 1.0000e-03  eta: 0:22:45  time: 0.0877  data_time: 0.0043  memory: 607  grad_norm: 1.8587  loss: 0.4628  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4628
07/29 02:07:16 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:07:16 - mmengine - INFO - Epoch(train)  [6][341/341]  lr: 1.0000e-03  eta: 0:22:40  time: 0.0883  data_time: 0.0041  memory: 607  grad_norm: 2.0265  loss: 0.5455  top1_acc: 1.0000  top5_acc: 1.0000  loss_cls: 0.5455
07/29 02:07:17 - mmengine - INFO - Epoch(val)  [6][50/98]    eta: 0:00:01  time: 0.0284  data_time: 0.0037  memory: 187  
07/29 02:07:18 - mmengine - INFO - Epoch(val) [6][98/98]    acc/top1: 0.6799  acc/mean1: 0.7007  data_time: 0.0040  time: 0.0287
07/29 02:07:23 - mmengine - INFO - Epoch(train)  [7][ 50/341]  lr: 9.9902e-04  eta: 0:22:34  time: 0.0882  data_time: 0.0042  memory: 607  grad_norm: 2.2689  loss: 0.5327  top1_acc: 0.8750  top5_acc: 1.0000  loss_cls: 0.5327
07/29 02:07:27 - mmengine - INFO - Epoch(train)  [7][100/341]  lr: 9.9902e-04  eta: 0:22:29  time: 0.0883  data_time: 0.0045  memory: 607  grad_norm: 1.9601  loss: 0.4943  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4943
07/29 02:07:32 - mmengine - INFO - Epoch(train)  [7][150/341]  lr: 9.9902e-04  eta: 0:22:25  time: 0.0927  data_time: 0.0044  memory: 607  grad_norm: 2.0148  loss: 0.4874  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4874
07/29 02:07:37 - mmengine - INFO - Epoch(train)  [7][200/341]  lr: 9.9902e-04  eta: 0:22:22  time: 0.0954  data_time: 0.0045  memory: 607  grad_norm: 2.0129  loss: 0.5026  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.5026
07/29 02:07:41 - mmengine - INFO - Epoch(train)  [7][250/341]  lr: 9.9902e-04  eta: 0:22:18  time: 0.0886  data_time: 0.0043  memory: 607  grad_norm: 1.6092  loss: 0.4988  top1_acc: 0.8750  top5_acc: 1.0000  loss_cls: 0.4988
07/29 02:07:45 - mmengine - INFO - Epoch(train)  [7][300/341]  lr: 9.9902e-04  eta: 0:22:12  time: 0.0851  data_time: 0.0042  memory: 607  grad_norm: 1.9926  loss: 0.5149  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.5149
07/29 02:07:49 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:07:49 - mmengine - INFO - Epoch(train)  [7][341/341]  lr: 9.9902e-04  eta: 0:22:08  time: 0.0956  data_time: 0.0041  memory: 607  grad_norm: 1.8173  loss: 0.5072  top1_acc: 1.0000  top5_acc: 1.0000  loss_cls: 0.5072
07/29 02:07:54 - mmengine - INFO - Epoch(train)  [8][ 50/341]  lr: 9.9610e-04  eta: 0:22:04  time: 0.0878  data_time: 0.0042  memory: 607  grad_norm: 1.8147  loss: 0.4278  top1_acc: 0.5000  top5_acc: 1.0000  loss_cls: 0.4278
07/29 02:07:59 - mmengine - INFO - Epoch(train)  [8][100/341]  lr: 9.9610e-04  eta: 0:22:01  time: 0.0951  data_time: 0.0045  memory: 607  grad_norm: 1.9102  loss: 0.4773  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4773
07/29 02:08:03 - mmengine - INFO - Epoch(train)  [8][150/341]  lr: 9.9610e-04  eta: 0:21:57  time: 0.0932  data_time: 0.0044  memory: 607  grad_norm: 1.9359  loss: 0.5007  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.5007
07/29 02:08:08 - mmengine - INFO - Epoch(train)  [8][200/341]  lr: 9.9610e-04  eta: 0:21:54  time: 0.0946  data_time: 0.0044  memory: 607  grad_norm: 1.6837  loss: 0.5092  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.5092
07/29 02:08:12 - mmengine - INFO - Epoch(train)  [8][250/341]  lr: 9.9610e-04  eta: 0:21:48  time: 0.0837  data_time: 0.0041  memory: 607  grad_norm: 1.7324  loss: 0.4448  top1_acc: 0.8750  top5_acc: 1.0000  loss_cls: 0.4448
07/29 02:08:17 - mmengine - INFO - Epoch(train)  [8][300/341]  lr: 9.9610e-04  eta: 0:21:43  time: 0.0881  data_time: 0.0042  memory: 607  grad_norm: 1.7138  loss: 0.5254  top1_acc: 0.5000  top5_acc: 1.0000  loss_cls: 0.5254
07/29 02:08:20 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:08:20 - mmengine - INFO - Epoch(train)  [8][341/341]  lr: 9.9610e-04  eta: 0:21:38  time: 0.0871  data_time: 0.0040  memory: 607  grad_norm: 1.6953  loss: 0.4226  top1_acc: 0.3333  top5_acc: 1.0000  loss_cls: 0.4226
07/29 02:08:22 - mmengine - INFO - Epoch(val)  [8][50/98]    eta: 0:00:01  time: 0.0315  data_time: 0.0040  memory: 187  
07/29 02:08:23 - mmengine - INFO - Epoch(val) [8][98/98]    acc/top1: 0.7686  acc/mean1: 0.7709  data_time: 0.0042  time: 0.0316
07/29 02:08:23 - mmengine - INFO - The previous best checkpoint /workspace/mmaction2/work_dirs/enhanced_fight_plus_stgcn_v3/best_acc_top1_epoch_2.pth is removed
07/29 02:08:23 - mmengine - INFO - The best checkpoint with 0.7686 acc/top1 at 8 epoch is saved to best_acc_top1_epoch_8.pth.
07/29 02:08:29 - mmengine - INFO - Epoch(train)  [9][ 50/341]  lr: 9.9123e-04  eta: 0:21:35  time: 0.0951  data_time: 0.0045  memory: 607  grad_norm: 1.6095  loss: 0.4075  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.4075
07/29 02:08:33 - mmengine - INFO - Epoch(train)  [9][100/341]  lr: 9.9123e-04  eta: 0:21:31  time: 0.0940  data_time: 0.0045  memory: 607  grad_norm: 1.9184  loss: 0.5208  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.5208
07/29 02:08:38 - mmengine - INFO - Epoch(train)  [9][150/341]  lr: 9.9123e-04  eta: 0:21:26  time: 0.0892  data_time: 0.0043  memory: 607  grad_norm: 1.4945  loss: 0.4630  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.4630
07/29 02:08:42 - mmengine - INFO - Epoch(train)  [9][200/341]  lr: 9.9123e-04  eta: 0:21:21  time: 0.0930  data_time: 0.0045  memory: 607  grad_norm: 1.6733  loss: 0.4467  top1_acc: 1.0000  top5_acc: 1.0000  loss_cls: 0.4467
07/29 02:08:47 - mmengine - INFO - Epoch(train)  [9][250/341]  lr: 9.9123e-04  eta: 0:21:18  time: 0.0948  data_time: 0.0044  memory: 607  grad_norm: 1.9754  loss: 0.4737  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.4737
07/29 02:08:49 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:08:51 - mmengine - INFO - Epoch(train)  [9][300/341]  lr: 9.9123e-04  eta: 0:21:13  time: 0.0886  data_time: 0.0042  memory: 607  grad_norm: 1.7153  loss: 0.4139  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4139
07/29 02:08:55 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:08:55 - mmengine - INFO - Epoch(train)  [9][341/341]  lr: 9.9123e-04  eta: 0:21:08  time: 0.0879  data_time: 0.0041  memory: 607  grad_norm: 1.5900  loss: 0.4691  top1_acc: 0.3333  top5_acc: 1.0000  loss_cls: 0.4691
07/29 02:09:00 - mmengine - INFO - Epoch(train) [10][ 50/341]  lr: 9.8445e-04  eta: 0:21:05  time: 0.0957  data_time: 0.0048  memory: 607  grad_norm: 1.2166  loss: 0.3594  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.3594
07/29 02:09:04 - mmengine - INFO - Epoch(train) [10][100/341]  lr: 9.8445e-04  eta: 0:21:01  time: 0.0876  data_time: 0.0042  memory: 607  grad_norm: 1.7478  loss: 0.4546  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4546
07/29 02:09:09 - mmengine - INFO - Epoch(train) [10][150/341]  lr: 9.8445e-04  eta: 0:20:56  time: 0.0891  data_time: 0.0042  memory: 607  grad_norm: 1.9943  loss: 0.5212  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.5212
07/29 02:09:13 - mmengine - INFO - Epoch(train) [10][200/341]  lr: 9.8445e-04  eta: 0:20:51  time: 0.0878  data_time: 0.0041  memory: 607  grad_norm: 1.6311  loss: 0.4924  top1_acc: 0.5000  top5_acc: 1.0000  loss_cls: 0.4924
07/29 02:09:18 - mmengine - INFO - Epoch(train) [10][250/341]  lr: 9.8445e-04  eta: 0:20:46  time: 0.0855  data_time: 0.0041  memory: 607  grad_norm: 1.7473  loss: 0.4961  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4961
07/29 02:09:22 - mmengine - INFO - Epoch(train) [10][300/341]  lr: 9.8445e-04  eta: 0:20:40  time: 0.0860  data_time: 0.0043  memory: 607  grad_norm: 1.3627  loss: 0.4092  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4092
07/29 02:09:26 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:09:26 - mmengine - INFO - Epoch(train) [10][341/341]  lr: 9.8445e-04  eta: 0:20:36  time: 0.0898  data_time: 0.0041  memory: 607  grad_norm: 1.6382  loss: 0.5129  top1_acc: 0.3333  top5_acc: 1.0000  loss_cls: 0.5129
07/29 02:09:26 - mmengine - INFO - Saving checkpoint at 10 epochs
07/29 02:09:27 - mmengine - INFO - Epoch(val) [10][50/98]    eta: 0:00:01  time: 0.0299  data_time: 0.0039  memory: 187  
07/29 02:09:29 - mmengine - INFO - Epoch(val) [10][98/98]    acc/top1: 0.7648  acc/mean1: 0.7608  data_time: 0.0040  time: 0.0295
07/29 02:09:34 - mmengine - INFO - Epoch(train) [11][ 50/341]  lr: 9.7577e-04  eta: 0:20:33  time: 0.0987  data_time: 0.0048  memory: 607  grad_norm: 1.5922  loss: 0.4935  top1_acc: 0.3750  top5_acc: 1.0000  loss_cls: 0.4935
07/29 02:09:38 - mmengine - INFO - Epoch(train) [11][100/341]  lr: 9.7577e-04  eta: 0:20:29  time: 0.0911  data_time: 0.0044  memory: 607  grad_norm: 1.2915  loss: 0.4320  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4320
07/29 02:09:43 - mmengine - INFO - Epoch(train) [11][150/341]  lr: 9.7577e-04  eta: 0:20:24  time: 0.0886  data_time: 0.0042  memory: 607  grad_norm: 1.6370  loss: 0.4514  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4514
07/29 02:09:47 - mmengine - INFO - Epoch(train) [11][200/341]  lr: 9.7577e-04  eta: 0:20:20  time: 0.0885  data_time: 0.0043  memory: 607  grad_norm: 1.9544  loss: 0.5500  top1_acc: 0.8750  top5_acc: 1.0000  loss_cls: 0.5500
07/29 02:09:52 - mmengine - INFO - Epoch(train) [11][250/341]  lr: 9.7577e-04  eta: 0:20:15  time: 0.0897  data_time: 0.0043  memory: 607  grad_norm: 1.5981  loss: 0.4649  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4649
07/29 02:09:56 - mmengine - INFO - Epoch(train) [11][300/341]  lr: 9.7577e-04  eta: 0:20:10  time: 0.0919  data_time: 0.0043  memory: 607  grad_norm: 1.6266  loss: 0.4586  top1_acc: 0.8750  top5_acc: 1.0000  loss_cls: 0.4586
07/29 02:10:00 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:10:00 - mmengine - INFO - Epoch(train) [11][341/341]  lr: 9.7577e-04  eta: 0:20:06  time: 0.0875  data_time: 0.0042  memory: 607  grad_norm: 1.4368  loss: 0.4724  top1_acc: 1.0000  top5_acc: 1.0000  loss_cls: 0.4724
07/29 02:10:05 - mmengine - INFO - Epoch(train) [12][ 50/341]  lr: 9.6524e-04  eta: 0:20:02  time: 0.0882  data_time: 0.0043  memory: 607  grad_norm: 1.3936  loss: 0.4534  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.4534
07/29 02:10:09 - mmengine - INFO - Epoch(train) [12][100/341]  lr: 9.6524e-04  eta: 0:19:57  time: 0.0866  data_time: 0.0042  memory: 607  grad_norm: 1.8043  loss: 0.4581  top1_acc: 0.8750  top5_acc: 1.0000  loss_cls: 0.4581
07/29 02:10:13 - mmengine - INFO - Epoch(train) [12][150/341]  lr: 9.6524e-04  eta: 0:19:51  time: 0.0874  data_time: 0.0043  memory: 607  grad_norm: 1.4724  loss: 0.4369  top1_acc: 0.7500  top5_acc: 1.0000  loss_cls: 0.4369
07/29 02:10:18 - mmengine - INFO - Epoch(train) [12][200/341]  lr: 9.6524e-04  eta: 0:19:47  time: 0.0903  data_time: 0.0043  memory: 607  grad_norm: 1.4623  loss: 0.4150  top1_acc: 0.6250  top5_acc: 1.0000  loss_cls: 0.4150
07/29 02:10:22 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:10:22 - mmengine - INFO - Epoch(train) [12][250/341]  lr: 9.6524e-04  eta: 0:19:42  time: 0.0869  data_time: 0.0043  memory: 607  grad_norm: 1.4108  loss: 0.4633  top1_acc: 0.5000  top5_acc: 1.0000  loss_cls: 0.4633
07/29 02:10:27 - mmengine - INFO - Epoch(train) [12][300/341]  lr: 9.6524e-04  eta: 0:19:37  time: 0.0909  data_time: 0.0044  memory: 607  grad_norm: 1.4210  loss: 0.4087  top1_acc: 0.8750  top5_acc: 1.0000  loss_cls: 0.4087
07/29 02:10:30 - mmengine - INFO - Exp name: stgcnpp_enhanced_fight_detection_20250729_020400
07/29 02:10:30 - mmengine - INFO - Epoch(train) [12][341/341]  lr: 9.6524e-04  eta: 0:19:33  time: 0.0861  data_time: 0.0041  memory: 607  grad_norm: inf  loss: 0.4752  top1_acc: 1.0000  top5_acc: 1.0000  loss_cls: 0.4752
07/29 02:10:32 - mmengine - INFO - Epoch(val) [12][50/98]    eta: 0:00:01  time: 0.0289  data_time: 0.0039  memory: 187  
07/29 02:10:33 - mmengine - INFO - Epoch(val) [12][98/98]    acc/top1: 0.7828  acc/mean1: 0.7712  data_time: 0.0041  time: 0.0297
07/29 02:10:33 - mmengine - INFO - The previous best checkpoint /workspace/mmaction2/work_dirs/enhanced_fight_plus_stgcn_v3/best_acc_top1_epoch_8.pth is removed
07/29 02:10:33 - mmengine - INFO - The best checkpoint with 0.7828 acc/top1 at 12 epoch is saved to best_acc_top1_epoch_12.pth.
07/29 02:10:34 - mmengine - INFO - the monitored metric did not improve in the last 5 records. best score: 0.762. 
